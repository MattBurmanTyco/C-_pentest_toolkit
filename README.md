# C-_pentest_toolkit
some tools that should be used for pen testing C#
http://www.harmj0y.net/blog/redteaming/ghostpack/ 

It’s a whole pen testing suite…think of kali linux focused on c#/.net

Granted, it would focus a lot of the operating system, but we can focus more on the ccure items…

One cool item would be:  SharpUp….
SharpUp
SharpUp is the start of a C# port of PowerUp‘s privilege escalation checks. Currently, only the most common checks have been ported; no weaponization functions have yet been implemented. The currently implemented checks are:

GetModifiableServices – Returns services the current user can modify
GetModifiableServiceBinaries – Returns services with binaries that the current user can modify
GetAlwaysInstallElevated – Returns any values for the AlwaysInstallElevated registry key
GetPathHijacks – Returns any folder in %PATH% that the current user can modify
GetModifiableRegistryAutoRuns – Returns any modifiable binaries/scripts set to run in HKLM auto-runs
GetSpecialTokenGroupPrivs – Returns “special” user privileges (e.g. SeDebugPrivilege/etc.)
GetUnattendedInstallFiles – Returns any left over unattended install files
GetMcAfeeSitelistFiles – Returns any McAfee SiteList.xml file locations






 
SeatBelt.exe system collects the following system data:

BasicOSInfo – Basic OS info (i.e. architecture, OS version, etc.)
RebootSchedule – Reboot schedule (last 15 days) based on event IDs 12 and 13
TokenGroupPrivs – Current process/token privileges (e.g. SeDebugPrivilege/etc.)
UACSystemPolicies – UAC system policies via the registry
PowerShellSettings – PowerShell versions and security settings via the registry
AuditSettings – Audit settings via the registry
WEFSettings – Windows Event Forwarding (WEF) settings via the registry
LSASettings – LSA settings (including auth packages)
UserEnvVariables – Current user environment variables
SystemEnvVariables – Current system environment variables
UserFolders – Folders in C:\Users\
NonstandardServices – Services with binary paths not in C:\Windows\
InternetSettings – Internet settings, including proxy configs
LapsSettings – LAPS settings, if installed
LocalGroupMembers – Members of local admins, RDP, and remote DCOM groups
MappedDrives – Currently mapped drives
RDPSessions – Current incoming RDP sessions
WMIMappedDrives – Mapped drives via WMI
NetworkShares – Network shares
FirewallRules – Deny firewall rules, “full” dumps all
AntiVirusWMI – Registered antivirus (via WMI)
InterestingProcesses – “Interesting” processes- defensive products and admin tools
RegistryAutoLogon – Registry autologon information
RegistryAutoRuns – Registry autoruns
DNSCache – DNS cache entries (via WMI)
ARPTable – Lists the current ARP table and adapter information (equivalent to arp -a)
AllTcpConnections – Lists current TCP connections and associated processes
AllUdpConnections – Lists current UDP connections and associated processes
NonstandardProcesses – Processes with binary paths not in C:\Windows\
If the user is in high integrity the following additional actions are run:

SysmonConfig – Sysmon configuration from the registry
SeatBelt.exe user collects the following user data:

Checks if Firefox has history files
Checks if Chrome has history files
TriageIE – Internet Explorer bookmarks and history, last 7 days
SavedRDPConnections – Saved RDP connections, including username hints
RecentRunCommands – Recent “run” commands
PuttySessions – Interesting settings from any saved Putty configurations
PuttySSHHostKeys – Saved putty SSH host keys
RecentFiles – Parsed “recent files” shortcuts, last 7 days
If the user is in high integrity, these checks are run for ALL users instead of just the current user.

Miscellaneous checks:

CurrentDomainGroups – The current user’s local and domain groups
Patches – Installed patches via WMI (takes a bit on some systems)
LogonSessions – User logon session data
KerberosTGTData – ALL TEH TGTZ!
InterestingFiles – “Interesting” files matching various patterns in the user’s folder
IETabs – Open Internet Explorer tabs
TriageChrome – Chrome bookmarks and history
TriageFirefox – Firefox history (no bookmarks)
RecycleBin – Items in the Recycle Bin deleted in the last 30 days – only works from a user context!
KerberosTickets – List Kerberos tickets. If elevated, list all grouped by all logon sessions.
4624Events – 4624 logon events from the security event log
4648Events – 4648 explicit logon events from the security event log
SeatBelt.exe all will run ALL enumeration checks, can be combined with full.

SeatBelt.exe [CheckName] [CheckName2] … will run one or more specified checks only (case-sensitive naming!)

SeatBelt.exe [system/user/all/CheckName] full will prevent any filtering and will return complete results. By default, certain checks are filtered (e.g. services NOT in C:\Windows\, etc.)
